var CommentBox=React.createClass({displayName:"CommentBox",getInitialState:function(){return{translations:{},comments:[],pagenum:0,total:0,current_page:1}},handleCommentSubmit:function(a){a.ajax=!0,yuanjs.ajax({type:"POST",url:"./index.php?controller=post&action=create",data:a,success:function(a){}.bind(this),error:function(a,b,c){}.bind(this)})},getAppConfig:function(a){var b=new Date;yuanjs.ajax({type:"GET",url:"index.php",data:{action:"getSysJSON",t:b.getTime()},dataType:"json",cache:!1,dataType:"json",success:a.bind(this),error:function(){}.bind(this)})},loadCommentsFromServer:function(){yuanjs.ajax({url:this.props.url,dataType:"json",method:"GET",cache:!1,data:{ajax:!0,pid:1},success:function(a){this.setState({comments:a.messages,pagenum:a.pagenum,total:a.total,current_page:a.current_page})}.bind(this),error:function(a,b,c){}.bind(this)})},componentDidMount:function(){this.getAppConfig(function(a){this.setState({translations:a}),this.loadCommentsFromServer()})},render:function(){return React.createElement("div",{className:"commentBox"},React.createElement("h1",null,"Welcome"),React.createElement(CommentStatistics,{current_page:this.state.current_page,total:this.state.total,pagenum:this.state.pagenum}),React.createElement(CommentList,{data:this.state.comments}),React.createElement(CommentForm,{onCommentSubmit:this.handleCommentSubmit}))}}),CommentStatistics=React.createClass({displayName:"CommentStatistics",render:function(){return React.createElement("div",{className:"statistics"},this.props.total)}}),CommentList=React.createClass({displayName:"CommentList",render:function(){var a=this.props.data.map(function(a){return React.createElement(Comment,{author:a.uname,key:a.id,time:a.time},a.post_content)});return React.createElement("div",{className:"commentList"},a)}}),Comment=React.createClass({displayName:"Comment",rawMarkup:function(){return{__html:this.props.children.toString()}},render:function(){return React.createElement("div",{className:"comment"},React.createElement("span",{className:"commentAuthor"},this.props.author),React.createElement("span",{className:"commentDate"},this.props.time),React.createElement("div",{className:"commentText",dangerouslySetInnerHTML:this.rawMarkup()}))}}),CommentForm=React.createClass({displayName:"CommentForm",handleSubmit:function(a){a.preventDefault();var b=this.refs.user.value.trim(),c=this.refs.content.value.trim();return b&&c?(this.props.onCommentSubmit({user:b,content:c}),this.refs.user.value="",this.refs.content.value="",!1):void 0},render:function(){return React.createElement("form",{onSubmit:this.handleSubmit,className:"commentForm"},React.createElement("input",{ref:"user",type:"text",placeholder:"Your name"}),React.createElement("input",{ref:"content",type:"text",placeholder:"Say something.."}),React.createElement("input",{type:"submit",value:"Post"}))}});ReactDOM.render(React.createElement(CommentBox,{url:"index.php",pollInterval:2e3}),document.getElementById("content"));
//# sourceMappingURL=index.js.map